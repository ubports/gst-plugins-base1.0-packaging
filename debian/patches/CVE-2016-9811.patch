From 2fdccfd64fc609e44e9c4b8eed5bfdc0ab9c9095 Mon Sep 17 00:00:00 2001
From: Matthew Waters <matthew@centricular.com>
Date: Wed, 23 Nov 2016 21:27:55 +1100
Subject: [PATCH] typefind: bounds check windows ico detection

Fixes out of bounds read

https://bugzilla.gnome.org/show_bug.cgi?id=774902
---
 gst/typefind/gsttypefindfunctions.c | 2 ++
 1 file changed, 2 insertions(+)

Index: gst-plugins-base1.0-1.8.3/gst/typefind/gsttypefindfunctions.c
===================================================================
--- gst-plugins-base1.0-1.8.3.orig/gst/typefind/gsttypefindfunctions.c	2017-03-23 12:50:11.719933181 -0400
+++ gst-plugins-base1.0-1.8.3/gst/typefind/gsttypefindfunctions.c	2017-03-23 12:50:11.715933131 -0400
@@ -5128,6 +5128,8 @@
   gint32 size, offset;
 
   datalen = gst_type_find_get_length (find);
+  if (datalen < 18)
+    return;
   if ((data = gst_type_find_peek (find, 0, 6)) == NULL)
     return;
 
